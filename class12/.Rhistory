install.packages("BiocManager")
BiocManager::install()
BiocManager::install("DESeq2")
library(BiocManager)
library(DESeq2)
counts <- read.csv("airway_scaledcounts.csv", row.names=1)
metadata <-  read.csv("airway_metadata.csv")
head(counts)
counts <- read.csv("airway_scaledcounts.csv", row.names=1)
metadata <-  read.csv("airway_metadata.csv")
View(counts)
head(counts)
nrow(counts)
nrow(metadata)
head(metadata)
View(counts)
ncol(control)
ncolumn(control)
dim(control)
ncol(counts)
control.means <- rowMeans(control.counts)
metadata$dex == "control"
control.counts <- counts[ , control.inds]
View(metadata)
sum(metadata$dex == "control")
metadata$dex == "control"
control.counts <- counts[ , control.inds]
View(counts)
control.inds <- metadata$dex == "control"
control.counts <- counts[ , control.inds]
control.means <- rowMeans(control.counts)
treated.inds <- metadata$dex == "treated"
treated.counts <- counts[ , treated.inds]
treated.means <- rowMeans(treated.counts)
library(ggplot)
library(ggplot2)
plot(control.counts, treated.counts)
meancounts <- data.frame(control.means, treated.means)
head(meancounts)
ggplot(meancounts) +
aes(control.means, treated.means) +
geom_point()
ggplot(meancounts) +
aes(control.means, treated.means) +
geom_point() +
scale_x_log10() +
scale_y_log10()
meancounts["log2fc"] <- log2(meancounts$treated.means / meancounts$control.means)
head(meancounts)
sum(meancounts$log2fc > +2, na.rm=True)
sum(meancounts$log2fc > +2, na.rm=T)
sum(meancounts$log2fc >= +2, na.rm=T)
sum(meancounts$log2fc <= -2, na.rm=t)
sum(meancounts$log2fc <= -2, na.rm=T)
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = counts,
colData = metadata,
design = ~dex)
dds <- DESeq(dds)
results(dds)
res <- results(dds)
head(res)
plot(res$log2FoldChange)
plot(res$log2FoldChange, res$padj)
plot(res$log2FoldChange, log(res$padj))
plot(res$log2FoldChange, -log(res$padj))
plot(res$log2FoldChange, -log(res$padj))
abline(v=(-2,2), col="red")
plot(res$log2FoldChange, -log(res$padj))
abline(v=c(-2,2), col="red")
plot(res$log2FoldChange, -log(res$padj))
abline(v=c(-2,2), col="red")
plot(res$log2FoldChange, -log(res$padj))
abline(v=c(-2,2), col="red") # ones that expression of genes w or w/o drug changes a lot
abline(h=-log(0.04), col="red")
write.csv(res, file="my_results.csv")
