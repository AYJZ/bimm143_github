hist(rnorm(500, mean=5, sd=0.5))
hist(rnorm(500, mean=5))
rnorm(30, mean=-3)
rnorm(30, mean=-3)
rnorm(30, mean=3)
c(rnorm(30, mean=-3), rnorm(30, mean=3))
x <- c(rnorm(30, mean=-3), rnorm(30, mean=3))
y <- rev(x)
x <- c(rnorm(30, mean=-3), rnorm(30, mean=3))
y <- rev(x)
y
x <- c(rnorm(30, mean=-3), rnorm(30, mean=3))
y <- rev(x)
cbind(x, y)
x <- cbind(x, y)
plot(x)
kmeans(x, centers = 2)
km <- kmeans(x, centers = 2)
km
View(km)
km$size
km$cluster
km$cluster
km$centers
plot(km)
plot(x, km)
plot(x, km$cluster)
tol <- cbind(x, y)
plot(tol)
km <- kmeans(tol, centers = 2)
km
km$size
km$cluster
km$centers
plot(x, y, colours = km$cluster)
plot(x, y)
plot(tol, km$cluster)
plot(tol)
?plot()
plot(tol, col=km$cluster)
plot(tol, col=km$cluster)
plot(tol, col=km)
plot(tol, col=km$centers)
plot(tol, col=km$cluster)
plot(tol, col= c("red", "blue"))
plot(tol, col=km$cluster)
plot(tol, col=km$cluster, pch=19)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue")
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=15)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=14)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=13)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=12)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=11)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=10)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=9)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=18)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=16)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=14)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=15)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=15, cex=2)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=14, cex=2)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=1, cex=2)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=18, cex=2)
km2 <- kmeans(total, centers=4)
km2 <- kmeans(total, centers=4)
km2 <- kmeans(tot, centers=4)
km2 <- kmeans(tol, centers=4)
plot(total, km2$cluster)
km2 <- kmeans(tol, centers=4)
plot(tol, km2$cluster)
km2 <- kmeans(tol, centers=4)
plot(tol, col=km2$cluster)
point(km2$centers, col="blue", pch=18, cex=2)
km2 <- kmeans(tol, centers=4)
plot(tol, col=km2$cluster)
points(km2$centers, col="blue", pch=18, cex=2)
km2 <- kmeans(tol, centers=4)
plot(tol, col=km2$cluster)
points(km2$centers, col="blue", pch=18, cex=2)
km2 <- kmeans(tol, centers=4)
plot(tol, col=km2$cluster)
points(km2$centers, col="blue", pch=18, cex=1.5)
plot(tol, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=18, cex=1.5)
km2 <- kmeans(tol, centers=4)
plot(tol, col=km2$cluster)
points(km2$centers, col="blue", pch=18, cex=1.5)
km2 <- kmeans(tol, centers=4)
plot(tol, col=km2$cluster, pch=16)
points(km2$centers, col="blue", pch=18, cex=1.5)
km2 <- kmeans(tol, centers=4)
plot(tol, col=km2$cluster)
points(km2$centers, col="blue", pch=18, cex=1.5)
km$withinss
mean(km$withinss)
?for
{}
?for()
ssvec <- c()
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withss <- mean(km$withinss)
ssvec[i] <- withss
}
ssvec <- c()
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withss <- mean(km$withinss)
ssvec[i] <- withss
}
plot("Numer of clusters (k)"=c(1:5), "Total within SS"=ssvec)
ssvec <- c()
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withss <- mean(km$withinss)
ssvec[i] <- withss
}
plot(c(1:5), ssvec)
?plot()
ssvec <- c()
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withss <- mean(km$withinss)
ssvec[i] <- withss
}
plot(c(1:5), ssvec, type="c", xlab="Numer of clusters (k)", ylab="Total within SS")
ssvec <- c()
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withss <- mean(km$withinss)
ssvec[i] <- withss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS")
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withss <- mean(km$withinss)
ssvec[i] <- withss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS")
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withss <- mean(km$withinss)
ssvec[i] <- withss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS")
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withinss <- mean(km$withinss)
ssvec[i] <- withinss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS")
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withinss <- mean(km$withinss)
ssvec[i] <- withinss
}
plot(c(1:5), ssvec, type="s", xlab="Numer of clusters (k)", ylab="Total within SS")
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withinss <- mean(km$withinss)
ssvec[i] <- withinss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS")
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withinss <- mean(km$withinss)
ssvec[i] <- withinss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS", title="Scree Plot")
for(i in c(1:5)){
km <- kmeans(tol, centers = i)
withinss <- mean(km$withinss)
ssvec[i] <- withinss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS", main="Scree Plot")
dist(tol)
hist(rnorm(500, mean=5))
x <- c(rnorm(30, mean=-3), rnorm(30, mean=3))
y <- rev(x)
x <- cbind(x, y)
plot(x)
km <- kmeans(x, centers = 2)
km
km$size
km$cluster
km$centers
plot(x, col=km$cluster, pch=16)
# if col=c("red", "blue), the vector would recycle to length of 60 alternating colors
points(km$centers, col="blue", pch=18, cex=1.5)
km2 <- kmeans(x, centers=4)
plot(x, col=km2$cluster)
points(km2$centers, col="blue", pch=18, cex=1.5)
# Within Sum of Square
mean(km$withinss)
for(i in c(1:5)){
km <- kmeans(x, centers = i)
withinss <- mean(km$withinss)
ssvec[i] <- withinss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS", main="Scree Plot")
dist(x)
d <- dist(x)
hclust(d)
d <- dist(x)
hc <- hclust(d)
hc
d <- dist(x)
hc <- hclust(d)
plot(hc)
d <- dist(x)
hc <- hclust(d)
hc
plot(hc)
d <- dist(x)
hc <- hclust(d)
hc
plot(hc)
plot(hc)
plot(hc)
abline(h=8, col='red')
plot(hc)
abline(h=8, col='red')
cutree(hc, h=8)
cutree(hc, h=8)
cutree(hc, h=8)
plot(hc)
abline(h=8, col='red')
cutree(hc, k=2)
plot(x, grps)
grps <- cutree(hc, k=2)
plot(x, grps)
plot(x, col = grps)
plot(x, col = grps, pch = 16)
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url)
head(x)
url <- "https://tinyurl.com/UK-foods"
x <- read.csv(url, row.names = 1)
head(x)
barplot(as.matrix(x), beside=T, col=rainbow(nrow(x)))
barplot(as.matrix(x), beside=F, col=rainbow(nrow(x)))
pairs(x, col=rainbow(nrow(x)), pch=16)
pca <- prcomp( t(x) )
?prcomp()
pca
summary(pca)
View(x)
pca$x
plot(pca$x)
cols <- c("orange","red","blue","green")
plot(pca$x[,1], pca$x[,2], col=cols, pch=16)
?plot()
cols <- c("orange","red","blue","green")
plot(pca$x[,1], pca$x[,2], col=cols, pch=16)
text(x, y, colnames(x))
cols <- c("orange","red","blue","green")
plot(pca$x[,1], pca$x[,2], col=cols, pch=16)
text(x, y, labels=colnames(x))
library(ggplot2)
cols <- c("orange","red","blue","green")
plot(pca$x[,1], pca$x[,2], col=cols, pch=16)
ggplot(pca$x) +
aes(PC1, PC2) +
geom_point(col = cols)
ggplot(pca$x) +
aes(PC1, PC2) +
geom_point(col = cols) +
theme_classic()
ggplot(pca$x) +
aes(PC1, PC2, size=5) +
geom_point(col = cols) +
theme_classic()
ggplot(pca$x) +
aes(PC1, PC2, size=3) +
geom_point(col = cols) +
theme_classic()
ggplot(pca$x) +
aes(PC1, PC) +
geom_point(col = cols) +
theme_classic()
ggplot(pca$x) +
aes(PC1, PC2) +
geom_point(col = cols) +
theme_classic()
pca$rotation
ggplot(pca$rotation) +
aes(PC1, rownames(pca$rotation)) +
geom_col()
# How much each variable weighs in the PCA
ssvec <- c()
for(i in 1:5){
km <- kmeans(x, centers = i)
ssvec[i] <- km$tot.withinss
}
plot(c(1:5), ssvec, type="o", xlab="Numer of clusters (k)", ylab="Total within SS", main="Scree Plot")
d <- dist(x)
hc <- hclust(d)
hc
d
d <- dist(x)
hc <- hclust(d)
hc
cols <- c("orange","red","blue","green")
plot(pca$x[,1], pca$x[,2], col=cols, pch=16)
pca <- prcomp( t(x) )
summary(pca)
# See how PC1 and PC2 captured 96% of the variance -> good enough representative of the data
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Desktop/Venn/")
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Desktop/UBE2G2 Figures/UpSet Plot")
GOBP_ERAD_PATHWAY <- readLines("GOBP_ERAD_PATHWAY.genes.txt")
ST7_ALL <- readLines("ST7_ALL.genes.txt")
ST8_ALL <- readLines("ST8_ALL.genes.txt")
library(ggupset)
library(ggplot2)
library(tibble)
library(dplyr)
data_list <- list(
GOBP_ERAD_PATHWAY = GOBP_ERAD_PATHWAY,
ST7_ALL = ST7_ALL,
ST8_ALL = ST8_ALL
)
# Get all unique genes from all sets
all_genes <- unique(unlist(data_list))
# Build a binary data frame
upset_data <- data.frame(
GOBP_ERAD_PATHWAY = as.numeric(all_genes %in% data_list$GOBP_ERAD_PATHWAY),
ST7_ALL = as.numeric(all_genes %in% data_list$ST7_ALL),
ST8_ALL = as.numeric(all_genes %in% data_list$ST8_ALL)
)
colnames(upset_data) <- c("GOBP ERAD Pathway", "ST7", "ST8")
rownames(upset_data) <- all_genes
# Create dataframe
sets_list <- apply(upset_data, 1, function(row) names(which(row == 1)))
df <- tibble(
gene = rownames(upset_data),
sets = sets_list
)
label_df <- df %>%
group_by(sets) %>%
summarise(
gene_names = paste(gene, collapse = "\n"),   # combine names into one string
n = n()                                       # number of genes in that intersection
) %>%
arrange(n) %>%                     # sort by size (smallest first)
slice_head(n = 3)                  # <-- take only the last 3 intersections
# Plot
ggplot(df, aes(x = sets)) +
geom_bar(fill = "#F5E1A1", color = "black", linewidth = 0.6, width = 0.6) +
scale_x_upset(order_by = "freq") +
labs(x = "Intersection", y = "Number of Genes") +
theme_classic(base_size = 5) +
theme(
axis.text.x = element_text(angle = 45, hjust = 10, size = 8),
axis.text.y = element_text(size = 10),
axis.title.x = element_text(size = 12, margin = margin(t = 5)),
axis.title.y = element_text(size = 12, margin = margin(r = 20, l = 20)),
plot.margin = margin(t = 20, b = 0, l = 5),
axis.line = element_line(linewidth = 0.3)
) +
geom_text(
stat = "count",
aes(label = after_stat(count)),
vjust = -0.55,       # vertical position (negative = above bar)
size = 3.5,         # font size for numbers
) +
geom_text(
data = label_df,
aes(x = sets, y = n + 12, label = gene_names),
angle = 0,              # diagonal labels
size = 3.2,                # text size
vjust = 0,        # bottom-align vertically
fontface = "italic"      # optional: italicize gene names (common in biology)
)
