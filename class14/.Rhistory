counts <- read.csv(file = "GSE37704_featurecounts.csv", row.names = 1)
metadata <- read.csv(file = "GSE37704_metadata.csv")
head(counts)
head(metadata)
nrow(metadata)
ncol(counts)
cleancounts <- counts[,-1]
all(colnames(cleancounts) ==metadata$id)
to.keep.ids <- rowSums(cleancounts)>0
nonzero_counts <- cleancounts[to.keep.ids,]
to.keep.ids <- rowSums(cleancounts)>0
nonzero_counts <- cleancounts[to.keep.ids,]
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = nonzero_counts,
colData = metadata,
design = ~condition)
dds <- DESeq(dds)
res <- results(dds)
head(res)
library(ggplot2)
ggplot(res) +
aes(log2FoldChange,
-log(padj))+
geom_point()+
theme_bw()
mycols <- rep("grey",nrow(res))
mycols[abs(res$log2FoldChange)>2] <- "blue"
mycols[res$pvalue>0.05] <- "grey"
ggplot(res)+
aes(log2FoldChange,
-log(padj))+
geom_point(col=mycols)+
theme_bw()+
geom_vline(xintercept=c(-2,2), col="red")+
geom_hline(yintercept = -log(0.05),col = "red")
library(AnnotationDbi)
library(AnnotationDbi)
install.packages("AnnotationDbi")
BiocManager::install("AnnotationDbi")
library(AnnotationDbi)
library(org.Hs.eg.db)
BiocManager::install("org.Hs.eg.db")
library(AnnotationDbi)
library(org.Hs.eg.db)
library(AnnotationDbi)
library(org.Hs.eg.db)
res$symbol <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "SYMBOL")
res$genename <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "GENENAME")
res$entrez <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "ENTREZID")
library(gage)
BiocManager::install("gage")
library(gage)
library(gageData)
BiocManager::install("gageData")
BiocManager::install("pathview")
library(gage)
library(gageData)
library(pathview)
data(kegg.sets.hs)
data(sigmet.idx.hs)
kegg.sets.hs = kegg.sets.hs[sigmet.idx.hs]
foldchanges = res$log2FoldChange
names(foldchanges) = res$entrez
head(foldchanges)
keggres = gage(foldchanges, gsets=kegg.sets.hs)
head(keggres$less)
pathview(pathway.id = "hsa04110", gene.data = foldchanges)
pathview(pathway.id = "hsa03030", gene.data = foldchanges)
pathview(pathway.id = "hsa03030", gene.data = foldchanges)
counts <- read.csv(file = "GSE37704_featurecounts.csv", row.names = 1)
metadata <- read.csv(file = "GSE37704_metadata.csv")
head(counts)
head(metadata)
nrow(metadata)
ncol(counts)
cleancounts <- counts[,-1]
all(colnames(cleancounts) ==metadata$id)
to.keep.ids <- rowSums(cleancounts)>0
nonzero_counts <- cleancounts[to.keep.ids,]
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = nonzero_counts,
colData = metadata,
design = ~condition)
dds <- DESeq(dds)
res <- results(dds)
head(res)
library(ggplot2)
ggplot(res) +
aes(log2FoldChange,
-log(padj))+
geom_point()+
theme_bw()
mycols <- rep("grey",nrow(res))
mycols[abs(res$log2FoldChange)>2] <- "blue"
mycols[res$pvalue>0.05] <- "grey"
ggplot(res)+
aes(log2FoldChange,
-log(padj))+
geom_point(col=mycols)+
theme_bw()+
geom_vline(xintercept=c(-2,2), col="red")+
geom_hline(yintercept = -log(0.05),col = "red")
library(AnnotationDbi)
library(org.Hs.eg.db)
res$symbol <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "SYMBOL")
res$genename <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "GENENAME")
res$entrez <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "ENTREZID")
library(gage)
library(gageData)
library(pathview)
data(kegg.sets.hs)
data(sigmet.idx.hs)
kegg.sets.hs = kegg.sets.hs[sigmet.idx.hs]
foldchanges = res$log2FoldChange
names(foldchanges) = res$entrez
head(foldchanges)
keggres = gage(foldchanges, gsets=kegg.sets.hs)
head(keggres$less)
pathview(pathway.id = "hsa04110", gene.data = foldchanges)
pathview(pathway.id = "hsa03030", gene.data = foldchanges)
pathview(pathway.id = "hsa03030", gene.data = foldchanges)
res <- results(dds)
head(res)
mycols <- rep("grey",nrow(res))
mycols[abs(res$log2FoldChange)>2] <- "blue"
mycols[res$pvalue>0.05] <- "grey"
ggplot(res)+
aes(log2FoldChange,
-log(padj))+
geom_point(col=mycols)+
theme_bw()+
geom_vline(xintercept=c(-2,2), col="red")+
geom_hline(yintercept = -log(0.05),col = "red")
data(kegg.sets.hs)
data(sigmet.idx.hs)
kegg.sets.hs = kegg.sets.hs[sigmet.idx.hs]
foldchanges = res$log2FoldChange
names(foldchanges) = res$entrez
head(foldchanges)
keggres = gage(foldchanges, gsets=kegg.sets.hs)
head(keggres$less)
pathview(pathway.id = "hsa04110", gene.data = foldchanges)
pathview(pathway.id = "hsa04110", gene.data = foldchanges)
pathview(pathway.id = "hsa03030", gene.data = foldchanges)
pathview(pathway.id = "hsa03030", gene.data = foldchanges)
counts <- read.csv(file = "GSE37704_featurecounts.csv", row.names = 1)
metadata <- read.csv(file = "GSE37704_metadata.csv")
head(counts)
head(metadata)
nrow(metadata)
ncol(counts)
cleancounts <- counts[,-1]
all(colnames(cleancounts) == metadata$id)
to.keep.ids <- rowSums(cleancounts)>0
nonzero_counts <- cleancounts[to.keep.ids,]
library(DESeq2)
dds <- DESeqDataSetFromMatrix(countData = nonzero_counts,
colData = metadata,
design = ~condition)
dds <- DESeq(dds)
res <- results(dds)
head(res)
library(ggplot2)
ggplot(res) +
aes(log2FoldChange,
-log(padj))+
geom_point()+
theme_bw()
mycols <- rep("grey",nrow(res))
mycols[abs(res$log2FoldChange)>2] <- "blue"
mycols[res$pvalue>0.05] <- "grey"
ggplot(res)+
aes(log2FoldChange,
-log(padj))+
geom_point(col=mycols)+
theme_bw()+
geom_vline(xintercept=c(-2,2), col="red")+
geom_hline(yintercept = -log(0.05),col = "red")
library(AnnotationDbi)
library(org.Hs.eg.db)
res$symbol <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "SYMBOL")
res$genename <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "GENENAME")
res$entrez <- mapIds(x=org.Hs.eg.db,
keys = row.names(res),
keytype = "ENSEMBL",
column = "ENTREZID")
library(gage)
library(gageData)
library(pathview)
data(kegg.sets.hs)
data(sigmet.idx.hs)
kegg.sets.hs = kegg.sets.hs[sigmet.idx.hs]
foldchanges = res$log2FoldChange
names(foldchanges) = res$entrez
head(foldchanges)
keggres = gage(foldchanges, gsets=kegg.sets.hs)
head(keggres$less)
pathview(pathway.id = "hsa04110", gene.data = foldchanges)
pathview(pathway.id = "hsa03030", gene.data = foldchanges)
data(go.sets.hs)
data(go.subs.hs)
# Focus on Biological Process subset of GO
gobpsets = go.sets.hs[go.subs.hs$BP]
gobpres = gage(foldchanges, gsets=gobpsets, same.dir=TRUE)
lapply(gobpres, head)
head(gobpres$less,4)
sig_genes <- res[res$padj <= 0.05 & !is.na(res$padj), ]$symbol
write.table(sig_genes, file="significant_genes.txt", row.names=FALSE, col.names=FALSE, quote=FALSE)
write.csv(res,file="myresults.csv")
