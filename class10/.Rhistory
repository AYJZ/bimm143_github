candy_file <- "candy-data.csv"
candy = read.csv(candy_file, row.names=1)
head(candy)
sum(candy$fruity.isna==False)
sum(candy$fruity.isna()==False)
sum(candy$fruity)
nrow(candy)
candy["Twix", ]$winpercent
View(candy)
candy["M&M's", ]$winpercent
candy["Kit Kat", ]$winpercent
candy["Tootsie Roll Snack Bars", ]$winpercent
install.packages("skimr")
library("skimr")
skim(candy)
library(ggplot2)
ggplot(candy) + aes(winpercent) +
geom_histogram()
ggplot(candy) + aes(winpercent) +
geom_hist()
ggplot(candy) + aes(winpercent) +
geom_histogram()
ggplot(candy) + aes(winpercent) +
geom_histogram(binwidth = 5)
ggplot(candy) + aes(winpercent) +
geom_histogram(binwidth = 10)
ggplot(candy) + aes(winpercent) +
geom_histogram(binwidth = 2)
ggplot(candy) + aes(winpercent) +
geom_histogram(binwidth = 5)
mean(candy$winpercent)
median(candy$winpercent)
mean_choc<- mean(candy$winpercent[as.logical(candy$chocolate)])
mean_fruit <- mean(candy$winpercent[as.logical(candy$fruity)])
mean_choc > mean_fruit
mean_chocolate <- mean(candy$winpercent[as.logical(candy$chocolate)])
mean_fruit <- mean(candy$winpercent[as.logical(candy$fruity)])
mean_chocolate > mean_fruit
chocolate <- candy$winpercent[as.logical(candy$chocolate)]
fruit <- candy$winpercent[as.logical(candy$fruity)]
mean(chocolate) > mean(fruit)
t.test(chocolate, fruit)
library(dplyr)
candy %>%
arrange(winpercent) %>%
head(5)
candy %>%
arrange(desc(winpercent)) %>%
head(5)
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_bar()
ggplot(candy) +
aes(winpercent, rownames(candy)) +
geom_col()
ggplot(candy) +
aes(winpercent, reorder(rownames(candy),winpercent)) +
geom_col()
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) +
aes(winpercent, reorder(rownames(candy),winpercent)) +
geom_col(fill=my_cols)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy),winpercent)) +
geom_col(col=mycols)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy),winpercent)) +
geom_col(fill=mycols)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy),winpercent)) +
geom_col(col=my_cols)
ggplot(candy) +
aes(winpercent, reorder(rownames(candy),winpercent)) +
geom_col(fill=my_cols)
library(ggrepel)
# How about a plot of price vs win
ggplot(candy) +
aes(winpercent, pricepercent, label=rownames(candy)) +
geom_point(col=my_cols) +
geom_text_repel(col=my_cols, size=3.3, max.overlaps = 5)
candy$best_ratio <- candy$winpercent / candy$pricepercent
candy$best_ratio <- candy$winpercent / candy$pricepercent
head(candy)
candy$best_ratio <- candy$winpercent / candy$pricepercent
candy[order(candy$bang_for_buck, decreasing = TRUE), ][1:5, c("winpercent", "pricepercent")]
candy$best_ratio <- candy$winpercent / candy$pricepercent
candy[order(candy$best_ratio, decreasing = TRUE), ][1:5, c("winpercent", "pricepercent")]
candy$best_ratio <- candy$winpercent / candy$pricepercent
candy[order(candy$best_ratio, decreasing = TRUE)]
rownames(candy)[which.max(candy$winpercent / candy$pricepercent)]
rownames(candy)[which.max(candy$winpercent / candy$pricepercent)]
ord <- order(candy$pricepercent, decreasing = TRUE)
head( candy[ord,c(11,12)], n=5 )
library(corrplot)
library(corrplot)
cij <- cor(candy)
corrplot(cij)
pca <- prcomp(candy, scale=TRUE)
summary(pca)
plot(pca$x[,1:2])
View(pca)
plot(pca$x[,1:2], col=my_cols, pch=16)
# Make a new data-frame with our PCA results and candy data
my_data <- cbind(candy, pca$x[,1:3])
p <- ggplot(my_data) +
aes(x=PC1, y=PC2,
size=winpercent/100,
text=rownames(my_data),
label=rownames(my_data)) +
geom_point(col=my_cols)
p
library(ggrepel)
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 7)  +
theme(legend.position = "none") +
labs(title="Halloween Candy PCA Space",
subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
caption="Data from 538")
library(plotly)
install.packages("plotly")
library(plotly)
ggplotly(p)
par(mar=c(8,4,2,2))
barplot(pca$rotation[,1], las=2, ylab="PC1 Contribution")
